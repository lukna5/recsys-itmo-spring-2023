# Объяснение моей рекомендательной системы
## Идея
Будем запоминать последний и больше всего понравившиеся треки пользователю.
Если прошлая рекомендация была плоха, то вернемся к предыдущему понравившемуся
Если было уже много плохих рекомендаций (фейлов), то вернемся к лучшему.
После этого при помощи Contextual подберем похожие треки. Если их нет, то дадим случайный
(не последний прослушенный) трек любимого артиста.
План разбить рекомендование на 2 шага:
1) Найдем трек на основе которого будем рекомендовать
2) Подберем треки при помощи этого

## Детали
### Подберем трек
1) Запоминаем как user относится к артисту
(для этого просто запоминаем среднее значение оценок артисту от этого пользователя).
Обновляем любимого артиста, если средний рейтинг нового артиста выше старого.
2) Проверяем понравился ли прошлый трек пользователю.
Если да, то сохраняем его как последний неплохой трек и обнуляем число фейлов.
Иначе присваем текущему треку последний неплохой трек и увеличиваем число плохих рекомендаций (фейлов).
3) Обновляем лучший трек и если было слишком много фейлов, то рекомендуем на основе лучшего трека
4) Если не смогли найти рекомендации на основе трека, то предложим ему трек любимого артиста,
но такого что, он не будет таким же, что он слушал последний раз у него.
5) \* Была идея, что раз дают список рекомендованных треков на основе текущего, то зачем брать рандомный,
если можно выбрать интересные среди них.
Я хотел рекомендовать, самые популярные треки среди рекомендованных или треки любимого артиста.
Но статистика резко падала, хотелось бы узнать почему это не зашло)
## Результат сравнения с contextual
![А/В эксперимент сранения с contextual](Statistic.png)
## Запуск
Запуск такой же, для анализа используется AnalyzeMyRecomender.ipynb
Если data не подгружается поменяйте на ваш путь до данных
# Рекомендательные Системы в Продакшене

## Лекции

Слайды лекций лежат в папке [slides](slides).

## Практика

Практическая часть курса построена вокруг музыкального рекомендера **botify**. 
На семинарах и в домашке мы будем развивать и анализировать этот рекомендер.

### Prerequisites

- Установить docker
- Сделать virtualenv c python (я использую версию 3.7)
- Вспомнить как пользоваться вашей любимой средой разработки (я использую PyCharm)

### Общее описание задачи

Пользователи приходят в музыкальный сервис **botify**, чтобы послушать музыку.
Сперва пользователь сам выбирает начальный трек.
Когда пользователь прослушал этот трек, сервис рекомендует следующий.
Пользователь может послушать рекомендованный трек или скипнуть его и перейти к следующему.
Либо пользователю может надоесть и он уйдет.
Как поступит пользователь зависит от качества рекомендаций: если они плохие - пользователь быстро уйдет; если хорошие – "залипнет".
Последовательность прослушанных пользователем треков мы будем называть "сессией".
На диаграмме ниже показан процесс одной сессии.  

![Взаимодействие пользователя с рекомендером botify](user-flow.png)

Цель сервиса **botify** – максимально долго удерживать пользователя.
Возможно, мы зарабатываем на рекламе или просто хотим набрать аудиторию.
Сервис меряет процент прослушки каждого трека из сессии и суммирует эти проценты, чтобы получить общую длину сессии (пренебрегаем тем, что треки могут длиться разное время – обычно песни длятся около 3 минут).
Качество рекомендаций напрямую влияет на то, сколько треков послушают пользователи и какой будет процент их прослушки.
Следовательно качество рекомендаций влияет на длину сессии и на успех всего сервиса в целом.

### Что есть в репозитории

#### botify

В этом модуле лежит заготовка сервиса рекомендера. 
В рамках заданий работать нужно будет над кодом из этого модуля.

[Описание и инструкции](botify/README.md)

#### sim

Так как наш рекомендер учебный, он не развернут для реальных пользователей. 
Но мы хотим экспериментировать с рекомендером как с настоящим.
Для этого в модуле sim реализован симулятор пользователя.
Запуская симулятор, мы генерируем трафик, похожий на трафик, который генерируют реальные пользователи.

[Описание и инструкции](sim/README.md)

#### jupyter

Ноутбуки с подготовкой данных для симулятора, визуализацией и всем таким.



